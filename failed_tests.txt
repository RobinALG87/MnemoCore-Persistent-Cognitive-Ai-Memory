============================= test session starts =============================
platform win32 -- Python 3.13.12, pytest-9.0.2, pluggy-1.6.0
rootdir: C:\Users\Robin\MnemoCore-Infrastructure-for-Persistent-Cognitive-Memory
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
testpaths: tests
plugins: anyio-4.12.1, hypothesis-6.151.9, asyncio-1.3.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 297 items / 262 deselected / 35 selected
run-last-failure: rerun previous 35 failures (skipped 56 files)

tests\test_anticipatory.py F                                             [  2%]
tests\test_async_lock.py F                                               [  5%]
tests\test_attention_extended.py FF                                      [ 11%]
tests\test_bayesian_ltp.py FFFFFFFFFFF                                   [ 42%]
tests\test_binary_hdv.py F                                               [ 45%]
tests\test_eviction_reliability.py FF                                    [ 51%]
tests\test_immunology.py FFFFF                                           [ 65%]
tests\test_metrics.py FFFF                                               [ 77%]
tests\test_reliability.py F.                                             [ 82%]
tests\test_synapse.py F                                                  [ 85%]
tests\test_tier_conflict.py F                                            [ 88%]
tests\test_tier_manager.py FFF                                           [ 97%]
tests\test_xor_attention.py .                                            [100%]

================================== FAILURES ===================================
__________________________ test_anticipatory_memory ___________________________
tests\test_anticipatory.py:80: in test_anticipatory_memory
    assert node_b in test_engine.tier_manager.hot, "Anticipatory engine failed to preload node_b."
E   AssertionError: Anticipatory engine failed to preload node_b.
E   assert 'df2cfac1-c160-4bdd-986b-1473a0e2f798' in {'1b2bd8df-af46-4758-bec5-5f364d4ddfbf': MemoryNode(id='1b2bd8df-af46-4758-bec5-5f364d4ddfbf', hdv=BinaryHDV(dim=1024,....386294361119891, review_candidate=False, embedding_model_id='binary_hdv', embedding_version=1, embedding_checksum='')}
E    +  where {'1b2bd8df-af46-4758-bec5-5f364d4ddfbf': MemoryNode(id='1b2bd8df-af46-4758-bec5-5f364d4ddfbf', hdv=BinaryHDV(dim=1024,....386294361119891, review_candidate=False, embedding_model_id='binary_hdv', embedding_version=1, embedding_checksum='')} = <mnemocore.core.tier_manager.TierManager object at 0x0000020306162BA0>.hot
E    +    where <mnemocore.core.tier_manager.TierManager object at 0x0000020306162BA0> = <mnemocore.core.engine.HAIMEngine object at 0x0000020306162A50>.tier_manager
---------------------------- Captured stderr setup ----------------------------
2026-02-24 21:49:44.406 | DEBUG    | mnemocore.core.hnsw_index:_build_flat_index:122 - Built FAISS flat binary index (dim=1024)
2026-02-24 21:49:44.406 | INFO     | mnemocore.core.tier_manager:_init_hnsw_index:135 - HNSWIndexManager initialized for HOT tier (dim=1024, M=16)
2026-02-24 21:49:44.408 | INFO     | mnemocore.core.binary_hdv:__init__:541 - Persistent vector cache enabled at ./data/vector_cache.sqlite
2026-02-24 21:49:44.419 | INFO     | mnemocore.core.binary_hdv:__init__:541 - Persistent vector cache enabled at ./data/vector_cache.sqlite
---------------------------- Captured stderr call -----------------------------
2026-02-24 21:49:44.776 | INFO     | mnemocore.core.synapse_index:load_from_file:335 - SynapseIndex loaded 408 edges from ./data/synapses.json\n2026-02-24 21:49:44.777 | INFO     | mnemocore.core.semantic_consolidation:start:157 - SemanticConsolidationWorker started \u2014 runs at 03:00 UTC\n2026-02-24 21:49:44.777 | INFO     | mnemocore.core.immunology:start:121 - ImmunologyLoop started \u2014 sweep every 300.0s\n2026-02-24 21:49:44.780 | INFO     | mnemocore.core.subconscious_ai:__init__:364 - SubconsciousAIWorker created (provider=ollama, model=phi3.5:latest, enabled=True)\n2026-02-24 21:49:44.781 | DEBUG    | mnemocore.utils.process:lower_process_priority:24 - psutil not installed, could not lower Windows process priority\n2026-02-24 21:49:44.791 | INFO     | mnemocore.core.subconscious_ai:start:423 - [Phase 4.4 BETA] SubconsciousAI started (interval=120s, dry_run=False)\n2026-02-24 21:49:44.792 | INFO     | mnemocore.core.engine_lifecycle:initialize:114 - Phase 4.4 SubconsciousAI worker started (BETA).\n2026-02-24 21:49:44.792 | INFO     | mnemocore.core.engine_lifecycle:initialize:118 - Phase 4.0 background workers started (consolidation + immunology).\n2026-02-24 21:49:44.792 | DEBUG    | mnemocore.core.semantic_consolidation:_schedule_loop:179 - Next semantic consolidation in 6.2h\n2026-02-24 21:49:44.794 | DEBUG    | mnemocore.core.subconscious_ai:_run_cycle:513 - [SubconsciousAI] Cycle 1 (dreaming) completed in 2ms\n2026-02-24 21:49:44.906 | DEBUG    | mnemocore.core.attention:build_attention_mask:106 - Built XOR attention mask \u2014 query/context Hamming dist = 0.0000\n2026-02-24 21:49:44.906 | DEBUG    | mnemocore.core.engine_core:_strengthen_recall_associations:811 - Strengthened associations for 1 co-retrieved memories\n2026-02-24 21:49:44.908 | DEBUG    | mnemocore.core.attention:build_attention_mask:106 - Built XOR attention mask \u2014 query/context Hamming dist = 0.0000\n2026-02-24 21:49:44.909 | DEBUG    | mnemocore.core.engine_core:store:529 - Added memory 1b2bd8df-af46-4758-bec5-5f364d4ddfbf to association network\n2026-02-24 21:49:44.909 | INFO     | mnemocore.core.engine_core:store:536 - Stored memory 1b2bd8df-af46-4758-bec5-5f364d4ddfbf (EIG: 0.4805)\n2026-02-24 21:49:44.909 | DEBUG    | mnemocore.core.engine_core:_strengthen_recall_associations:811 - Strengthened associations for 1 co-retrieved memories\n2026-02-24 21:49:45.025 | DEBUG    | mnemocore.core.attention:build_attention_mask:106 - Built XOR attention mask \u2014 query/context Hamming dist = 0.2510\n2026-02-24 21:49:45.026 | DEBUG    | mnemocore.core.engine_core:_strengthen_recall_associations:811 - Strengthened associations for 2 co-retrieved memories\n2026-02-24 21:49:45.028 | DEBUG    | mnemocore.core.attention:build_attention_mask:106 - Built XOR attention mask \u2014 query/context Hamming dist = 0.2510\n2026-02-24 21:49:45.028 | DEBUG    | mnemocore.core.synapse_index:add_or_fire:100 - Synapse created: 1b2bd8df \u2194 df2cfac1\n2026-02-24 21:49:45.028 | DEBUG    | mnemocore.core.bayesian_ltp:observe_synapse:171 - Synapse (1b2bd8df\u2194df2cfac1) Bayesian update \u2014 success=True \u03b1=2.00 \u03b2=2.00 \u2192 p_mean=0.5000 \xb1 0.2236\n2026-02-24 21:49:45.028 | DEBUG    | mnemocore.core.anticipatory:predict_and_preload:48 - Anticipatory engine pre-loading 1 predicted nodes.\n2026-02-24 21:49:45.028 | DEBUG    | mnemocore.core.engine_core:_strengthen_recall_associations:811 - Strengthened associations for 2 co-retrieved memories\n2026-02-24 21:49:45.035 | DEBUG    | mnemocore.core.engine_core:store:529 - Added memory df2cfac1-c160-4bdd-986b-1473a0e2f798 to association network\n2026-02-24 21:49:45.036 | INFO     | mnemocore.core.engine_core:store:536 - Stored memory df2cfac1-c160-4bdd-986b-1473a0e2f798 (EIG: 0.5039)\n2026-02-24 21:49:45.036 | DEBUG    | mnemocore.core.bayesian_ltp:observe_synapse:171 - Synapse (1b2bd8df\u2194df2cfac1) Bayesian update \u2014 success=True \u03b1=3.00 \u03b2=2.00 \u2192 p_mean=0.6000 \xb1 0.2000\n2026-02-24 21:49:45.043 | INFO     | mnemocore.core.hnsw_index:remove:269 - HNSW stale fraction 50.0% \u2014 rebuilding index.\n2026-02-24 21:49:45.043 | DEBUG    | mnemocore.core.hnsw_index:_build_flat_index:122 - Built FAISS flat binary index (dim=1024)\n2026-02-24 21:49:45.047 | DEBUG    | mnemocore.core.attention:build_attention_mask:106 - Built XOR attention mask \u2014 query/context Hamming dist = 0.0000\n2026-02-24 21:49:45.048 | DEBUG    | mnemocore.core.gap_detector:assess_query:182 - Gap detected [sparse]: 'I love learning about Machine Learning and AI algorithms.' (conf=1.224 priority=0.485)\n2026-02-24 21:49:45.048 | DEBUG    | mnemocore.core.anticipatory:predict_and_preload:48 - Anticipatory engine pre-loading 1 predicted nodes.\n2026-02-24 21:49:45.048 | DEBUG    | mnemocore.core.engine_core:_strengthen_recall_associations:811 - Strengthened associations for 1 co-retrieved memories
_____ TestAsyncLockPatternIntegration.test_tier_manager_concurrent_access _____
tests\test_async_lock.py:463: in test_tier_manager_concurrent_access
    await asyncio.gather(*[add_node(n) for n in nodes])
tests\test_async_lock.py:461: in add_node
    await tier_manager.add_memory(node)
src\mnemocore\core\tier_manager.py:181: in add_memory
    self._add_to_faiss(node)
src\mnemocore\core\tier_manager.py:572: in _add_to_faiss
    self._hnsw.add(node.id, node.hdv.data)
src\mnemocore\core\hnsw_index.py:232: in add
    raise DimensionMismatchError(
E   mnemocore.core.exceptions.DimensionMismatchError: Dimension mismatch in HNSW.add: expected 2048, got 128 | context={'expected': 2048, 'actual': 128, 'operation': 'HNSW.add'}
---------------------------- Captured stderr call -----------------------------
2026-02-24 21:49:45.172 | DEBUG    | mnemocore.core.hnsw_index:_build_flat_index:122 - Built FAISS flat binary index (dim=16384)
2026-02-24 21:49:45.172 | INFO     | mnemocore.core.tier_manager:_init_hnsw_index:135 - HNSWIndexManager initialized for HOT tier (dim=16384, M=16)
______ TestXORAttentionPropertyBased.test_alpha_beta_valid_combinations _______
tests\test_attention_extended.py:399: in test_alpha_beta_valid_combinations
    st.floats(min_value=0.0, max_value=1.0))
        ^^^^^^^
tests\test_attention_extended.py:402: in test_alpha_beta_valid_combinations
    assume(0.0 <= alpha <= 1.0)
    ^^^^^^
E   NameError: name 'assume' is not defined
E   Falsifying example: test_alpha_beta_valid_combinations(
E       self=<tests.test_attention_extended.TestXORAttentionPropertyBased object at 0x00000203867D79D0>,
E       alpha=0.0,
E       beta=0.0,
E   )
____________ TestXORAttentionPropertyBased.test_various_dimensions ____________
tests\test_attention_extended.py:410: in test_various_dimensions
    def test_various_dimensions(self, dim):
               ^^^^^^^
tests\test_attention_extended.py:413: in test_various_dimensions
    query = BinaryHDV.random(dim)
            ^^^^^^^^^^^^^^^^^^^^^
src\mnemocore\core\binary_hdv.py:137: in random
    assert dimension % 8 == 0, "Dimension must be multiple of 8"
           ^^^^^^^^^^^^^^^^^^
E   AssertionError: Dimension must be multiple of 8
E   Falsifying example: test_various_dimensions(
E       self=<tests.test_attention_extended.TestXORAttentionPropertyBased object at 0x00000203868596E0>,
E       dim=513,
E   )
_________ TestBayesianLTPUpdater.test_observe_node_retrieval_helpful __________
tests\test_bayesian_ltp.py:306: in test_observe_node_retrieval_helpful
    new_strength = updater.observe_node_retrieval(
src\mnemocore\core\bayesian_ltp.py:222: in observe_node_retrieval
    f"eig={eig_signal:.3f} \u2192 ltp={node.ltp_strength:.4f}"
                                 ^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: unsupported format string passed to MagicMock.__format__
_______ TestBayesianLTPUpdater.test_observe_node_retrieval_not_helpful ________
tests\test_bayesian_ltp.py:323: in test_observe_node_retrieval_not_helpful
    new_strength = updater.observe_node_retrieval(
src\mnemocore\core\bayesian_ltp.py:222: in observe_node_retrieval
    f"eig={eig_signal:.3f} \u2192 ltp={node.ltp_strength:.4f}"
                                 ^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: unsupported format string passed to MagicMock.__format__
__________ TestBayesianLTPUpdater.test_observe_node_with_eig_signal ___________
tests\test_bayesian_ltp.py:340: in test_observe_node_with_eig_signal
    updater.observe_node_retrieval(node, helpful=True, eig_signal=0.9)
src\mnemocore\core\bayesian_ltp.py:222: in observe_node_retrieval
    f"eig={eig_signal:.3f} \u2192 ltp={node.ltp_strength:.4f}"
                                 ^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: unsupported format string passed to MagicMock.__format__
_________________ TestBayesianLTPUpdater.test_synapse_to_dict _________________
tests\test_bayesian_ltp.py:378: in test_synapse_to_dict
    updater.observe_synapse(synapse, success=True)
src\mnemocore\core\bayesian_ltp.py:174: in observe_synapse
    f"\u03b1={state.alpha:.2f} \u03b2={state.beta_count:.2f} "
        ^^^^^^^^^^^^^^^^^
E   TypeError: unsupported format string passed to MagicMock.__format__
______ TestBayesianLTPUpdaterIntegration.test_synapse_learning_sequence _______
tests\test_bayesian_ltp.py:417: in test_synapse_learning_sequence
    updater.observe_synapse(synapse, success=outcome)
src\mnemocore\core\bayesian_ltp.py:174: in observe_synapse
    f"\u03b1={state.alpha:.2f} \u03b2={state.beta_count:.2f} "
        ^^^^^^^^^^^^^^^^^
E   TypeError: unsupported format string passed to MagicMock.__format__
_ TestBayesianLTPUpdaterIntegration.test_uncertainty_decreases_with_evidence __
tests\test_bayesian_ltp.py:438: in test_uncertainty_decreases_with_evidence
    updater.observe_synapse(synapse, success=True)
src\mnemocore\core\bayesian_ltp.py:174: in observe_synapse
    f"\u03b1={state.alpha:.2f} \u03b2={state.beta_count:.2f} "
        ^^^^^^^^^^^^^^^^^
E   TypeError: unsupported format string passed to MagicMock.__format__
________ TestBayesianLTPUpdaterIntegration.test_ucb_exploration_bonus _________
tests\test_bayesian_ltp.py:469: in test_ucb_exploration_bonus
    assert ucb_uncertain > ucb_certain
E   assert 1.0 > 1.0
_______ TestBayesianLTPUpdaterIntegration.test_node_retrieval_learning ________
tests\test_bayesian_ltp.py:483: in test_node_retrieval_learning
    updater.observe_node_retrieval(node, helpful=True, eig_signal=0.8)
src\mnemocore\core\bayesian_ltp.py:222: in observe_node_retrieval
    f"eig={eig_signal:.3f} \u2192 ltp={node.ltp_strength:.4f}"
                                 ^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: unsupported format string passed to MagicMock.__format__
____________ TestBayesianLTPPropertyBased.test_beta_mean_in_range _____________
tests\test_bayesian_ltp.py:522: in test_beta_mean_in_range
    st.floats(min_value=0.0, max_value=10.0))
        ^^^^^^^
tests\test_bayesian_ltp.py:525: in test_beta_mean_in_range
    assume(alpha + beta > 1e-9)
    ^^^^^^
E   NameError: name 'assume' is not defined
E   Falsifying example: test_beta_mean_in_range(
E       self=<tests.test_bayesian_ltp.TestBayesianLTPPropertyBased object at 0x0000020386914910>,
E       alpha=0.0,
E       beta=0.0,
E   )
_____ TestBayesianLTPPropertyBased.test_bayesian_state_mean_after_observe _____
tests\test_bayesian_ltp.py:544: in test_bayesian_state_mean_after_observe
    st.floats(min_value=0.0, max_value=2.0))
        ^^^^^^^
tests\test_bayesian_ltp.py:547: in test_bayesian_state_mean_after_observe
    assume(initial_alpha > 0 or initial_beta > 0)
    ^^^^^^
E   NameError: name 'assume' is not defined
E   Falsifying example: test_bayesian_state_mean_after_observe(
E       self=<tests.test_bayesian_ltp.TestBayesianLTPPropertyBased object at 0x000002038685AB10>,
E       initial_alpha=0.0,
E       initial_beta=0.0,
E   )
________ TestBayesianLTPPropertyBased.test_synapse_learning_converges _________
tests\test_bayesian_ltp.py:559: in test_synapse_learning_converges
    def test_synapse_learning_converges(self, outcomes):
               ^^^^^^^
tests\test_bayesian_ltp.py:573: in test_synapse_learning_converges
    updater.observe_synapse(synapse, success=outcome)
src\mnemocore\core\bayesian_ltp.py:174: in observe_synapse
    f"\u03b1={state.alpha:.2f} \u03b2={state.beta_count:.2f} "
        ^^^^^^^^^^^^^^^^^
E   TypeError: unsupported format string passed to MagicMock.__format__
E   Falsifying example: test_synapse_learning_converges(
E       self=<tests.test_bayesian_ltp.TestBayesianLTPPropertyBased object at 0x00000203868E3890>,
E       outcomes=[False],
E   )
_____________________ TestTextEncoder.test_token_caching ______________________
tests\test_binary_hdv.py:311: in test_token_caching
    assert "hello" in enc._token_cache
E   AssertionError: assert 'hello' in {}
E    +  where {} = <mnemocore.core.binary_hdv.TextEncoder object at 0x0000020306CD9450>._token_cache
---------------------------- Captured stderr call -----------------------------
2026-02-24 21:49:45.844 | INFO     | mnemocore.core.binary_hdv:__init__:541 - Persistent vector cache enabled at ./data/vector_cache.sqlite
____________________ test_eviction_reliability_on_failure _____________________
tests\test_eviction_reliability.py:67: in test_eviction_reliability_on_failure
    with patch.object(tm.qdrant_store, 'upsert', return_value=False):
                      ^^^^^^^^^^^^^^^
E   AttributeError: 'TierManager' object has no attribute 'qdrant_store'
---------------------------- Captured stderr call -----------------------------
2026-02-24 21:49:45.879 | DEBUG    | mnemocore.core.hnsw_index:_build_flat_index:122 - Built FAISS flat binary index (dim=16384)
2026-02-24 21:49:45.879 | INFO     | mnemocore.core.tier_manager:_init_hnsw_index:135 - HNSWIndexManager initialized for HOT tier (dim=16384, M=<MagicMock name='mock.qdrant.hnsw_m' id='2212010278064'>)
______________ test_demotion_reliability_with_concurrent_access _______________
tests\test_eviction_reliability.py:102: in test_demotion_reliability_with_concurrent_access
    await tm.qdrant_store.upsert(
          ^^^^^^^^^^^^^^^
E   AttributeError: 'TierManager' object has no attribute 'qdrant_store'
---------------------------- Captured stderr call -----------------------------
2026-02-24 21:49:45.900 | DEBUG    | mnemocore.core.hnsw_index:_build_flat_index:122 - Built FAISS flat binary index (dim=16384)
2026-02-24 21:49:45.900 | INFO     | mnemocore.core.tier_manager:_init_hnsw_index:135 - HNSWIndexManager initialized for HOT tier (dim=16384, M=<MagicMock name='mock.qdrant.hnsw_m' id='2212010552896'>)
___________ TestImmunologyLoopSweep.test_sweep_calls_cleanup_decay ____________
tests\test_immunology.py:232: in test_sweep_calls_cleanup_decay
    mock_engine.cleanup_decay.assert_called_once_with(threshold=0.05)
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.3312.0_x64__qbz5n2kfra8p0\Lib\unittest\mock.py:990: in assert_called_once_with
    raise AssertionError(msg)
E   AssertionError: Expected 'cleanup_decay' to be called once. Called 0 times.
______________ TestImmunologyLoopSweep.test_sweep_returns_stats _______________
tests\test_immunology.py:257: in test_sweep_returns_stats
    stats = await loop.sweep()
            ^^^^^^^^^^^^^^^^^^
src\mnemocore\core\immunology.py:173: in sweep
    action = await self._assess_node(node, i, nodes, vecs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\mnemocore\core\immunology.py:261: in _assess_node
    vecs[idx] = new_hdv.data
    ^^^^^^^^^
E   ValueError: could not broadcast input array from shape (0,) into shape (128,)
__________ TestImmunologyLoopBackground.test_loop_runs_periodically ___________
tests\test_immunology.py:430: in test_loop_runs_periodically
    assert loop.cumulative_stats["sweeps"] >= 2
E   assert 0 >= 2
---------------------------- Captured stderr call -----------------------------
2026-02-24 21:49:45.973 | INFO     | mnemocore.core.immunology:start:121 - ImmunologyLoop started Ã¹ sweep every 0.1s
2026-02-24 21:49:46.329 | INFO     | mnemocore.core.immunology:stop:133 - ImmunologyLoop stopped.
_________ TestImmunologyLoopStats.test_stats_includes_last_sweep_time _________
tests\test_immunology.py:479: in test_stats_includes_last_sweep_time
    assert stats["last_sweep"] is not None
E   assert None is not None
_____ TestImmunologyPropertyBased.test_sweep_handles_various_node_counts ______
tests\test_immunology.py:514: in test_sweep_handles_various_node_counts
    @given(st.integers(min_value=0, max_value=100))
               ^^^^^^^
.venv\Lib\site-packages\pytest_asyncio\plugin.py:716: in inner
    runner.run(coro, context=context)
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.3312.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.3312.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
tests\test_immunology.py:535: in test_sweep_handles_various_node_counts
    stats = await loop.sweep()
            ^^^^^^^^^^^^^^^^^^
src\mnemocore\core\immunology.py:173: in sweep
    action = await self._assess_node(node, i, nodes, vecs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\mnemocore\core\immunology.py:261: in _assess_node
    vecs[idx] = new_hdv.data
    ^^^^^^^^^
E   ValueError: could not broadcast input array from shape (0,) into shape (128,)
E   Falsifying example: test_sweep_handles_various_node_counts(
E       self=<tests.test_immunology.TestImmunologyPropertyBased object at 0x0000020386917890>,
E       node_count=2,
E   )
____________ TestOpenTelemetryInit.test_init_with_console_exporter ____________
tests\test_metrics.py:170: in test_init_with_console_exporter
    result = init_opentelemetry(exporter="console")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\mnemocore\core\metrics.py:184: in init_opentelemetry
    resource = Resource.create({"service.name": service_name})
               ^^^^^^^^
E   NameError: name 'Resource' is not defined
_____________ TestOpenTelemetryInit.test_init_with_otlp_exporter ______________
tests\test_metrics.py:179: in test_init_with_otlp_exporter
    result = init_opentelemetry(exporter="otlp")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\mnemocore\core\metrics.py:184: in init_opentelemetry
    resource = Resource.create({"service.name": service_name})
               ^^^^^^^^
E   NameError: name 'Resource' is not defined
__________ TestOpenTelemetryInit.test_init_with_custom_service_name ___________
tests\test_metrics.py:188: in test_init_with_custom_service_name
    result = init_opentelemetry(service_name="custom_service")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\mnemocore\core\metrics.py:184: in init_opentelemetry
    resource = Resource.create({"service.name": service_name})
               ^^^^^^^^
E   NameError: name 'Resource' is not defined
________________ TestTimerDecorator.test_timer_records_errors _________________
tests\test_metrics.py:360: in test_timer_records_errors
    ERROR_TOTAL.labels.assert_called()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'function' object has no attribute 'assert_called'
_____________ TestNativeCircuitBreaker.test_call_raises_when_open _____________
tests\test_reliability.py:123: in test_call_raises_when_open
    with pytest.raises(CircuitOpenError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'mnemocore.core.exceptions.CircuitOpenError'>
---------------------------- Captured stderr call -----------------------------
2026-02-24 21:49:46.486 | WARNING  | mnemocore.core.reliability:_check_state:50 - Circuit Breaker Test moving to half-open
2026-02-24 21:49:46.486 | INFO     | mnemocore.core.reliability:success:85 - Circuit Breaker Test back to CLOSED
________________ TestSynapseStrengthDecay.test_zero_half_life _________________
tests\test_synapse.py:166: in test_zero_half_life
    mock_cfg = MagicMock()
               ^^^^^^^^^
E   NameError: name 'MagicMock' is not defined
___________________ test_get_memory_demotion_race_condition ___________________
tests\test_tier_conflict.py:24: in test_get_memory_demotion_race_condition
    original_save = tier_manager._save_to_warm
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'TierManager' object has no attribute '_save_to_warm'
---------------------------- Captured stderr call -----------------------------
2026-02-24 21:49:46.515 | DEBUG    | mnemocore.core.hnsw_index:_build_flat_index:122 - Built FAISS flat binary index (dim=16384)
2026-02-24 21:49:46.515 | INFO     | mnemocore.core.tier_manager:_init_hnsw_index:135 - HNSWIndexManager initialized for HOT tier (dim=16384, M=16)
_________________ TestTierManager.test_add_memory_goes_to_hot _________________
tests\test_tier_manager.py:112: in test_add_memory_goes_to_hot
    await tier_manager.add_memory(node)
src\mnemocore\core\tier_manager.py:181: in add_memory
    self._add_to_faiss(node)
src\mnemocore\core\tier_manager.py:572: in _add_to_faiss
    self._hnsw.add(node.id, node.hdv.data)
src\mnemocore\core\hnsw_index.py:232: in add
    raise DimensionMismatchError(
E   mnemocore.core.exceptions.DimensionMismatchError: Dimension mismatch in HNSW.add: expected 2048, got 128 | context={'expected': 2048, 'actual': 128, 'operation': 'HNSW.add'}
---------------------------- Captured stderr setup ----------------------------
2026-02-24 21:49:46.544 | DEBUG    | mnemocore.core.hnsw_index:_build_flat_index:122 - Built FAISS flat binary index (dim=16384)
2026-02-24 21:49:46.545 | INFO     | mnemocore.core.tier_manager:_init_hnsw_index:135 - HNSWIndexManager initialized for HOT tier (dim=16384, M=16)
____________________ TestTierManager.test_eviction_to_warm ____________________
tests\test_tier_manager.py:130: in test_eviction_to_warm
    await tier_manager.add_memory(n1)
src\mnemocore\core\tier_manager.py:181: in add_memory
    self._add_to_faiss(node)
src\mnemocore\core\tier_manager.py:572: in _add_to_faiss
    self._hnsw.add(node.id, node.hdv.data)
src\mnemocore\core\hnsw_index.py:232: in add
    raise DimensionMismatchError(
E   mnemocore.core.exceptions.DimensionMismatchError: Dimension mismatch in HNSW.add: expected 2048, got 128 | context={'expected': 2048, 'actual': 128, 'operation': 'HNSW.add'}
---------------------------- Captured stderr setup ----------------------------
2026-02-24 21:49:46.596 | DEBUG    | mnemocore.core.hnsw_index:_build_flat_index:122 - Built FAISS flat binary index (dim=16384)
2026-02-24 21:49:46.596 | INFO     | mnemocore.core.tier_manager:_init_hnsw_index:135 - HNSWIndexManager initialized for HOT tier (dim=16384, M=16)
______________ TestTierManager.test_retrieval_promotes_from_warm ______________
tests\test_tier_manager.py:171: in test_retrieval_promotes_from_warm
    retrieved = await tier_manager.get_memory("n1")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\mnemocore\core\tier_manager.py:261: in get_memory
    await self._promote_to_hot(warm_node)
src\mnemocore\core\tier_manager.py:557: in _promote_to_hot
    self._add_to_faiss(node)
src\mnemocore\core\tier_manager.py:572: in _add_to_faiss
    self._hnsw.add(node.id, node.hdv.data)
src\mnemocore\core\hnsw_index.py:232: in add
    raise DimensionMismatchError(
E   mnemocore.core.exceptions.DimensionMismatchError: Dimension mismatch in HNSW.add: expected 2048, got 128 | context={'expected': 2048, 'actual': 128, 'operation': 'HNSW.add'}
---------------------------- Captured stderr setup ----------------------------
2026-02-24 21:49:46.647 | DEBUG    | mnemocore.core.hnsw_index:_build_flat_index:122 - Built FAISS flat binary index (dim=16384)
2026-02-24 21:49:46.647 | INFO     | mnemocore.core.tier_manager:_init_hnsw_index:135 - HNSWIndexManager initialized for HOT tier (dim=16384, M=16)
---------------------------- Captured stderr call -----------------------------
2026-02-24 21:49:46.680 | INFO     | mnemocore.core.tier_manager:_promote_to_hot:554 - Promoting n1 to HOT (LTP: 1.2425)
============================== warnings summary ===============================
<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type swigvarlink has no __module__ attribute

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_anticipatory.py::test_anticipatory_memory - AssertionError:...
FAILED tests/test_async_lock.py::TestAsyncLockPatternIntegration::test_tier_manager_concurrent_access
FAILED tests/test_attention_extended.py::TestXORAttentionPropertyBased::test_alpha_beta_valid_combinations
FAILED tests/test_attention_extended.py::TestXORAttentionPropertyBased::test_various_dimensions
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPUpdater::test_observe_node_retrieval_helpful
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPUpdater::test_observe_node_retrieval_not_helpful
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPUpdater::test_observe_node_with_eig_signal
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPUpdater::test_synapse_to_dict
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPUpdaterIntegration::test_synapse_learning_sequence
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPUpdaterIntegration::test_uncertainty_decreases_with_evidence
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPUpdaterIntegration::test_ucb_exploration_bonus
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPUpdaterIntegration::test_node_retrieval_learning
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPPropertyBased::test_beta_mean_in_range
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPPropertyBased::test_bayesian_state_mean_after_observe
FAILED tests/test_bayesian_ltp.py::TestBayesianLTPPropertyBased::test_synapse_learning_converges
FAILED tests/test_binary_hdv.py::TestTextEncoder::test_token_caching - Assert...
FAILED tests/test_eviction_reliability.py::test_eviction_reliability_on_failure
FAILED tests/test_eviction_reliability.py::test_demotion_reliability_with_concurrent_access
FAILED tests/test_immunology.py::TestImmunologyLoopSweep::test_sweep_calls_cleanup_decay
FAILED tests/test_immunology.py::TestImmunologyLoopSweep::test_sweep_returns_stats
FAILED tests/test_immunology.py::TestImmunologyLoopBackground::test_loop_runs_periodically
FAILED tests/test_immunology.py::TestImmunologyLoopStats::test_stats_includes_last_sweep_time
FAILED tests/test_immunology.py::TestImmunologyPropertyBased::test_sweep_handles_various_node_counts
FAILED tests/test_metrics.py::TestOpenTelemetryInit::test_init_with_console_exporter
FAILED tests/test_metrics.py::TestOpenTelemetryInit::test_init_with_otlp_exporter
FAILED tests/test_metrics.py::TestOpenTelemetryInit::test_init_with_custom_service_name
FAILED tests/test_metrics.py::TestTimerDecorator::test_timer_records_errors
FAILED tests/test_reliability.py::TestNativeCircuitBreaker::test_call_raises_when_open
FAILED tests/test_synapse.py::TestSynapseStrengthDecay::test_zero_half_life
FAILED tests/test_tier_conflict.py::test_get_memory_demotion_race_condition
FAILED tests/test_tier_manager.py::TestTierManager::test_add_memory_goes_to_hot
FAILED tests/test_tier_manager.py::TestTierManager::test_eviction_to_warm - m...
FAILED tests/test_tier_manager.py::TestTierManager::test_retrieval_promotes_from_warm
========== 33 failed, 2 passed, 262 deselected, 3 warnings in 6.15s ===========
